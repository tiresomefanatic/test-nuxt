import{g as J,r as d,i as j,k as O,l as Q,o as a,c as o,b as t,M as B,N as R,p as _,B as W,n as y,e as p,t as c,q as m,I as X,J as Y,K as ee,a as te}from"./C7abP_sL.js";import{u as se,C as ae}from"./BzhZBeE0.js";import{u as oe}from"./BmaLfZEm.js";const ne={class:"icon",viewBox:"0 0 24 24",width:"24",height:"24"},le={key:0,fill:"currentColor",d:"M21 15.75c0-.414-.336-.75-.75-.75H3.75a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 .75-.75ZM21 12c0-.414-.336-.75-.75-.75H3.75a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 .75-.75ZM3.75 9h16.5a.75.75 0 0 0 0-1.5H3.75a.75.75 0 0 0 0 1.5Z"},ce={key:1,fill:"currentColor",d:"M5.72 5.72a.75.75 0 0 1 1.06 0L12 10.94l5.22-5.22a.75.75 0 1 1 1.06 1.06L13.06 12l5.22 5.22a.75.75 0 1 1-1.06 1.06L12 13.06l-5.22 5.22a.75.75 0 0 1-1.06-1.06L10.94 12 5.72 6.78a.75.75 0 0 1 0-1.06Z"},re={class:"sidebar-content"},ie={class:"tabs"},ue=["onClick"],de={key:0,class:"count"},ve={key:0,class:"tab-content"},he={class:"pr-actions-header"},_e={key:1,class:"loading"},fe={key:2,class:"empty-state"},me={key:3,class:"pr-list"},be={class:"pr-header"},ge={class:"pr-number"},ye={class:"pr-title"},pe={class:"pr-meta"},Ce={class:"pr-author"},ke=["src","alt"],we={class:"pr-actions"},Be=["onClick"],Re=["onClick"],qe={key:1,class:"tab-content"},Ee={key:0,class:"loading"},Ne={key:1,class:"empty-state"},Pe={key:2,class:"commit-list"},$e={class:"commit-header"},Se={class:"commit-message"},Le={class:"commit-meta"},Me={class:"commit-author"},Fe=["src","alt"],He={class:"commit-date"},xe={key:2,class:"tab-content"},Ve={key:0,class:"conflict-resolver"},De={class:"conflict-header"},Ie={class:"conflict-diff"},Te={class:"diff-header"},Ze={class:"diff-content"},Ge={key:0,class:"diff-view current"},Ke={key:1,class:"diff-view incoming"},Ae={class:"conflict-actions"},Ue={key:1,class:"empty-state"},ze={key:3,class:"tab-content"},Je={class:"section"},je={key:0,class:"branch-controls"},Oe={class:"branch-controls"},Qe={class:"current-branch"},We=["value"],Xe=["value"],Ye={class:"new-branch"},et=["disabled"],tt={key:1,class:"login-prompt"},st=J({__name:"CollaborationSidebar",setup(at){const C=d(!1),f=d("branches"),l=d(!1),b=d([]),k=d([]),r=d(null),v=d("current"),h=d(""),g=d(!1),{showToast:u}=oe(),{getPullRequests:S,getCommits:L,resolveConflict:M,fetchBranches:w,createBranch:F,switchBranch:H,currentBranch:q,branches:E,isLoggedIn:N}=se(),x=j(()=>[{id:"prs",label:"Pull Requests",count:b.value.length},{id:"history",label:"History",count:k.value.length},{id:"conflicts",label:"Conflicts",count:b.value.filter(s=>s.mergeable===!1).length},{id:"branches",label:"Branches",count:E.value.length}]);O(N,async s=>{s&&await w()});const V=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),D=s=>s.mergeable===!1?"Has Conflicts":s.mergeable===!0?"Ready to Merge":"Checking",I=()=>{C.value=!C.value},T=s=>{window.open(s,"_blank")},Z=async()=>{g.value=!1,await P()},G=s=>{var n;if(!((n=s.files)!=null&&n[0])){u("No files found in pull request","error");return}r.value={file:s.files[0].filename,current:s.files[0].patch||"",incoming:s.files[0].patch||"",pr:s},f.value="conflicts"},K=async()=>{if(r.value){l.value=!0;try{await M(r.value.pr.number,r.value.file,v.value==="current"?"ours":"theirs"),u("Conflict resolved successfully!","success"),r.value=null,await P()}catch(s){console.error("Error resolving conflict:",s),u("Failed to resolve conflict. Please try again.","error")}finally{l.value=!1}}},A=()=>{r.value=null,v.value="current"},P=async()=>{l.value=!0;try{const s=await S();b.value=s}catch(s){console.error("Error loading pull requests:",s),u("Failed to load pull requests","error")}finally{l.value=!1}},U=async()=>{l.value=!0;try{const s=await L();k.value=s}catch(s){console.error("Error loading commits:",s),u("Failed to load commits","error")}finally{l.value=!1}};Q(async()=>{if(N.value){l.value=!0;try{await Promise.all([P(),U(),w()])}finally{l.value=!1}}});const z=async s=>{const n=s.target,e=n.value;try{if(l.value=!0,console.log(`Attempting to switch to branch: ${e}`),await H(e))u({title:"Success",message:`Switched to branch: ${e}`,type:"success"}),await w();else throw new Error("Failed to switch branch")}catch(i){console.error("Error switching branch:",i),u({title:"Error",message:i instanceof Error?i.message:"Failed to switch branch",type:"error"}),n.value=q.value}finally{l.value=!1}},$=async()=>{if(h.value)try{if(l.value=!0,console.log(`Creating new branch: ${h.value}`),await F(h.value))u({title:"Success",message:`Created and switched to branch: ${h.value}`,type:"success"}),await w(),h.value="";else throw new Error("Failed to create branch")}catch(s){console.error("Error creating branch:",s),u({title:"Error",message:s instanceof Error?s.message:"Failed to create branch",type:"error"})}finally{l.value=!1}};return(s,n)=>(a(),o("div",{class:m(["collaboration-sidebar",{open:C.value}])},[t("button",{class:"toggle-button",onClick:I},[(a(),o("svg",ne,[C.value?(a(),o("path",ce)):(a(),o("path",le))]))]),t("div",re,[t("div",ie,[(a(!0),o(B,null,R(x.value,e=>(a(),o("button",{key:e.id,class:m(["tab-button",{active:f.value===e.id}]),onClick:i=>f.value=e.id},[p(c(e.label)+" ",1),e.count?(a(),o("span",de,c(e.count),1)):_("",!0)],10,ue))),128))]),f.value==="prs"?(a(),o("div",ve,[t("div",he,[g.value?_("",!0):(a(),o("button",{key:0,class:"create-pr-button",onClick:n[0]||(n[0]=e=>g.value=!0)}," Create Pull Request "))]),g.value?(a(),W(ae,{key:0,branches:y(E),currentBranch:y(q),onCreated:Z,onCancel:n[1]||(n[1]=e=>g.value=!1)},null,8,["branches","currentBranch"])):l.value?(a(),o("div",_e,n[5]||(n[5]=[t("div",{class:"spinner"},null,-1),p(" Loading pull requests... ")]))):b.value.length===0?(a(),o("div",fe," No open pull requests ")):(a(),o("div",me,[(a(!0),o(B,null,R(b.value,e=>(a(),o("div",{key:e.number,class:m(["pr-item",{"has-conflicts":e.mergeable===!1}])},[t("div",be,[t("span",ge,"#"+c(e.number),1),t("span",ye,c(e.title),1)]),t("div",pe,[t("span",Ce,[t("img",{src:e.user.avatar_url,alt:e.user.login,class:"author-avatar"},null,8,ke),p(" "+c(e.user.login),1)]),t("span",{class:m(["pr-status",e.mergeable_state])},c(D(e)),3)]),t("div",we,[t("button",{class:"action-button view",onClick:i=>T(e.html_url)}," View on GitHub ",8,Be),e.mergeable===!1?(a(),o("button",{key:0,class:"action-button resolve",onClick:i=>G(e)}," Resolve Conflicts ",8,Re)):_("",!0)])],2))),128))]))])):_("",!0),f.value==="history"?(a(),o("div",qe,[l.value?(a(),o("div",Ee,n[6]||(n[6]=[t("div",{class:"spinner"},null,-1),p(" Loading commit history... ")]))):k.value.length===0?(a(),o("div",Ne," No commit history available ")):(a(),o("div",Pe,[(a(!0),o(B,null,R(k.value,e=>{var i;return a(),o("div",{key:e.sha,class:"commit-item"},[t("div",$e,[t("span",Se,c(e.commit.message),1)]),t("div",Le,[t("span",Me,[(i=e.author)!=null&&i.avatar_url?(a(),o("img",{key:0,src:e.author.avatar_url,alt:e.commit.author.name,class:"author-avatar"},null,8,Fe)):_("",!0),p(" "+c(e.commit.author.name),1)]),t("span",He,c(V(e.commit.author.date)),1)])])}),128))]))])):_("",!0),f.value==="conflicts"?(a(),o("div",xe,[r.value?(a(),o("div",Ve,[t("div",De,[n[7]||(n[7]=t("h3",null,"Resolve Conflicts",-1)),t("p",null,"Choose which changes to keep for "+c(r.value.file),1)]),t("div",Ie,[t("div",Te,[t("button",{class:m(["diff-button",{active:v.value==="current"}]),onClick:n[2]||(n[2]=e=>v.value="current")}," Current Changes ",2),t("button",{class:m(["diff-button",{active:v.value==="incoming"}]),onClick:n[3]||(n[3]=e=>v.value="incoming")}," Incoming Changes ",2)]),t("div",Ze,[v.value==="current"?(a(),o("pre",Ge,"                "+c(r.value.current)+`
              `,1)):(a(),o("pre",Ke,"                "+c(r.value.incoming)+`
              `,1))])]),t("div",Ae,[t("button",{class:"action-button cancel",onClick:A}," Cancel "),t("button",{class:"action-button resolve",onClick:K}," Accept "+c(v.value==="current"?"Current":"Incoming")+" Changes ",1)])])):(a(),o("div",Ue,"No conflicts to resolve"))])):_("",!0),f.value==="branches"?(a(),o("div",ze,[t("div",Je,[n[10]||(n[10]=t("h3",null,"Branch Management",-1)),y(N)?(a(),o("div",je,[t("div",Oe,[t("div",Qe,[n[8]||(n[8]=t("span",{class:"label"},"Current Branch:",-1)),t("select",{value:y(q),onChange:z},[(a(!0),o(B,null,R(y(E),e=>(a(),o("option",{key:e,value:e},c(e),9,Xe))),128))],40,We)]),t("div",Ye,[X(t("input",{"onUpdate:modelValue":n[4]||(n[4]=e=>h.value=e),placeholder:"New branch name",onKeyup:ee($,["enter"])},null,544),[[Y,h.value]]),t("button",{class:"create-branch",disabled:!h.value||l.value,onClick:$}," Create Branch ",8,et)])])])):(a(),o("div",tt,n[9]||(n[9]=[t("p",null,"Please log in to manage branches",-1)])))])])):_("",!0)])],2))}}),ct=te(st,[["__scopeId","data-v-47ebfc09"]]);export{ct as default};
